# üîí –ê–ù–ê–õ–ò–ó –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò –ü–†–û–ï–ö–¢–ê TAPPER

## üìä **–û–ë–©–ê–Ø –û–¶–ï–ù–ö–ê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò: 7.5/10**

---

## ‚úÖ **–°–ò–õ–¨–ù–´–ï –°–¢–û–†–û–ù–´ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò**

### üîê **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:**
- ‚úÖ **NextAuth.js v5** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
- ‚úÖ **bcrypt** –¥–ª—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π (12 rounds)
- ‚úÖ **JWT —Å—Ç—Ä–∞—Ç–µ–≥–∏—è** –¥–ª—è —Å–µ—Å—Å–∏–π
- ‚úÖ **–†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** (user/admin) —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π
- ‚úÖ **–ó–∞—â–∏—Ç–∞ –æ—Ç —Å–∞–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è** - –∞–¥–º–∏–Ω—ã –Ω–µ –º–æ–≥—É—Ç —É–¥–∞–ª–∏—Ç—å —Å–µ–±—è
- ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** –≤ API

### üõ°Ô∏è **–ó–∞—â–∏—Ç–∞ API:**
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Å—Å–∏–π** –≤–æ –≤—Å–µ—Ö –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–∞—Ö
- ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** (email, username, URL)
- ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** –±–µ–∑ —É—Ç–µ—á–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- ‚úÖ **Rate limiting** —á–µ—Ä–µ–∑ Redis (—á–∞—Å—Ç–∏—á–Ω–æ)
- ‚úÖ **CORS –∑–∞—â–∏—Ç–∞** —á–µ—Ä–µ–∑ Next.js

### üóÑÔ∏è **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:**
- ‚úÖ **Prisma ORM** - –∑–∞—â–∏—Ç–∞ –æ—Ç SQL –∏–Ω—ä–µ–∫—Ü–∏–π
- ‚úÖ **–ò–Ω–¥–µ–∫—Å—ã** –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ **Cascade —É–¥–∞–ª–µ–Ω–∏–µ** –¥–ª—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
- ‚úÖ **–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è** (email, username)

---

## ‚ö†Ô∏è **–£–Ø–ó–í–ò–ú–û–°–¢–ò –ò –†–ò–°–ö–ò**

### üî¥ **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:**

#### **1. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Rate Limiting:**
```typescript
// –ù–ï–¢ –∑–∞—â–∏—Ç—ã –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞
// –ù–ï–¢ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–∞ API –∑–∞–ø—Ä–æ—Å—ã
// –ù–ï–¢ –∑–∞—â–∏—Ç—ã –æ—Ç DDoS
```

#### **2. –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ª–æ–≥–∏:**
```typescript
// 42 console.log/error/warn –≤ –∫–æ–¥–µ
console.error("Auth error:", error) // –ú–æ–∂–µ—Ç —Ä–∞—Å–∫—Ä—ã—Ç—å –ø–∞—Ä–æ–ª–∏
console.log('Updated user data:', updatedUser) // –£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö
```

#### **3. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ CSRF –∑–∞—â–∏—Ç—ã:**
```typescript
// –ù–ï–¢ CSRF —Ç–æ–∫–µ–Ω–æ–≤
// –ù–ï–¢ –ø—Ä–æ–≤–µ—Ä–∫–∏ Origin –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
```

### üü° **–°—Ä–µ–¥–Ω–∏–µ —Ä–∏—Å–∫–∏:**

#### **4. –°–ª–∞–±–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–æ–ª–µ–π:**
```typescript
// –ù–ï–¢ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø–∞—Ä–æ–ª—è
// –ù–ï–¢ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã
// –ù–ï–¢ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ø–∞—Ä–æ–ª–∏
```

#### **5. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ 2FA:**
```typescript
// –ù–ï–¢ –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
// –ù–ï–¢ TOTP/SMS –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
```

#### **6. –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏:**
```typescript
// –ù–ï–¢ Content Security Policy
// –ù–ï–¢ X-Frame-Options
// –ù–ï–¢ X-Content-Type-Options
```

---

## üßπ **–õ–ò–®–ù–ò–ï –î–ê–ù–ù–´–ï –ò –ö–û–ú–ú–ï–ù–¢–ê–†–ò–ò**

### üìù **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è:**
- **12 –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤** "–¥–ª—è –¥–µ–º–æ" - –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å
- **42 console.log** - —É–±—Ä–∞—Ç—å –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
- **–ú–Ω–æ–∂–µ—Å—Ç–≤–æ TODO** –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç ‚úÖ

### üóëÔ∏è **–ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–æ–¥:**
- **Admin Settings** - —Ç–æ–ª—å–∫–æ UI, –Ω–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- **localStorage –¥–µ–º–æ –∫–æ–¥** - –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É
- **–ó–∞–≥–ª—É—à–∫–∏** –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –∞–¥–º–∏–Ω–∫–∏

### üì¶ **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞:**
- **40 localStorage –≤—ã–∑–æ–≤–æ–≤** - –º–æ–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å
- **–ú–Ω–æ–∂–µ—Å—Ç–≤–æ –∏–º–ø–æ—Ä—Ç–æ–≤** - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ
- **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞** –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö

---

## üöÄ **–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –£–õ–£–ß–®–ï–ù–ò–Æ**

### üî• **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö—Ä–∏—Ç–∏—á–Ω–æ):**

#### **1. –î–æ–±–∞–≤–∏—Ç—å Rate Limiting:**
```typescript
// middleware.ts
import { NextResponse } from 'next/server'
import { Ratelimit } from '@upstash/ratelimit'
import { Redis } from '@upstash/redis'

const ratelimit = new Ratelimit({
  redis: Redis.fromEnv(),
  limiter: Ratelimit.slidingWindow(10, '1 m'),
})
```

#### **2. –£–±—Ä–∞—Ç—å –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ª–æ–≥–∏:**
```typescript
// –ó–∞–º–µ–Ω–∏—Ç—å console.error –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
const logger = {
  error: (message: string, error?: unknown) => {
    if (process.env.NODE_ENV === 'development') {
      console.error(message, error)
    }
    // –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ Sentry/LogRocket
  }
}
```

#### **3. –î–æ–±–∞–≤–∏—Ç—å CSRF –∑–∞—â–∏—Ç—É:**
```typescript
// csrf.ts
import { createHash, randomBytes } from 'crypto'

export function generateCSRFToken(): string {
  return randomBytes(32).toString('hex')
}

export function validateCSRFToken(token: string, secret: string): boolean {
  // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞
}
```

### üî∂ **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í–∞–∂–Ω–æ):**

#### **4. –£–ª—É—á—à–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –ø–∞—Ä–æ–ª–µ–π:**
```typescript
const passwordSchema = z.string()
  .min(8, '–ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤')
  .regex(/[A-Z]/, '–ù—É–∂–Ω–∞ –∑–∞–≥–ª–∞–≤–Ω–∞—è –±—É–∫–≤–∞')
  .regex(/[0-9]/, '–ù—É–∂–Ω–∞ —Ü–∏—Ñ—Ä–∞')
  .regex(/[^A-Za-z0-9]/, '–ù—É–∂–µ–Ω —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª')
```

#### **5. –î–æ–±–∞–≤–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏:**
```typescript
// next.config.js
const securityHeaders = [
  {
    key: 'X-DNS-Prefetch-Control',
    value: 'on'
  },
  {
    key: 'X-XSS-Protection',
    value: '1; mode=block'
  },
  {
    key: 'X-Frame-Options',
    value: 'SAMEORIGIN'
  },
  {
    key: 'X-Content-Type-Options',
    value: 'nosniff'
  },
  {
    key: 'Referrer-Policy',
    value: 'origin-when-cross-origin'
  }
]
```

### üî∑ **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ):**

#### **6. –î–æ–±–∞–≤–∏—Ç—å 2FA:**
```typescript
// two-factor.ts
import { authenticator } from 'otplib'
import QRCode from 'qrcode'

export async function generate2FASecret(userId: string) {
  const secret = authenticator.generateSecret()
  const otpauth = authenticator.keyuri(userId, 'Tapper', secret)
  const qrCode = await QRCode.toDataURL(otpauth)
  return { secret, qrCode }
}
```

#### **7. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
```typescript
// security-monitor.ts
import * as Sentry from '@sentry/nextjs'

export function trackSecurityEvent(event: string, data: any) {
  Sentry.captureMessage(`Security: ${event}`, {
    level: 'warning',
    extra: data
  })
}
```

---

## üìà **–ü–õ–ê–ù –£–õ–£–ß–®–ï–ù–ò–ô**

### **–ù–µ–¥–µ–ª—è 1:**
- [ ] –£–±—Ä–∞—Ç—å –≤—Å–µ console.log –∏–∑ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
- [ ] –î–æ–±–∞–≤–∏—Ç—å Rate Limiting
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏

### **–ù–µ–¥–µ–ª—è 2:**
- [ ] –£–ª—É—á—à–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –ø–∞—Ä–æ–ª–µ–π
- [ ] –î–æ–±–∞–≤–∏—Ç—å CSRF –∑–∞—â–∏—Ç—É
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### **–ù–µ–¥–µ–ª—è 3:**
- [ ] –î–æ–±–∞–≤–∏—Ç—å 2FA
- [ ] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å localStorage
- [ ] –û—á–∏—Å—Ç–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–æ–¥

---

## üéØ **–ò–¢–û–ì–û–í–ê–Ø –û–¶–ï–ù–ö–ê**

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –û—Ü–µ–Ω–∫–∞ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|----------|--------|-------------|
| **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** | 8/10 | –•–æ—Ä–æ—à–∞—è, –Ω–æ –Ω–µ—Ç 2FA |
| **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** | 9/10 | –û—Ç–ª–∏—á–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π |
| **API –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** | 6/10 | –ù–µ—Ç Rate Limiting |
| **–í–∞–ª–∏–¥–∞—Ü–∏—è** | 7/10 | –•–æ—Ä–æ—à–∞—è, –Ω–æ —Å–ª–∞–±—ã–µ –ø–∞—Ä–æ–ª–∏ |
| **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** | 4/10 | –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ª–æ–≥–∏ |
| **–ó–∞–≥–æ–ª–æ–≤–∫–∏** | 3/10 | –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç |
| **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** | 5/10 | –ë–∞–∑–æ–≤—ã–π |

### **–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞: 7.5/10**

**–ü—Ä–æ–µ–∫—Ç –∏–º–µ–µ—Ç —Ö–æ—Ä–æ—à—É—é –æ—Å–Ω–æ–≤—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞!**
